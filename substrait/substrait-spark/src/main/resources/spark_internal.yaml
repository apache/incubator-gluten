%YAML 1.2
---
scalar_functions:
  -
    name: unscaled
    description:  >-
      Return the unscaled Long value of a Decimal, assuming it fits in a Long.
      Note: this expression is internal and created only by the optimizer, 
      we don't need to do type check for it.
    impls:
      - args:
          - name: input
            value: DECIMAL<P,S>
        return: i64
  -
    name: make_decimal
    description: >-
      Create a Decimal from an unscaled Long value. 
      Note: this expression is internal and created only by the optimizer, 
      we don't need to do type check for it.
    impls:
      - args:
          - name: input
            value: i64
          - name: precision
            value: i32
          - name: scale
            value: i32
          - name: nullOnOverflow
            value: boolean
        return: DECIMAL<P,S>
  -
    name: "equal_nullsafe"
    description: >-
      Returns same result as the EQUAL(=) operator for non-null operands,
      but returns true if both are null, false if one of the them is null.
    impls:
      - args:
          - value: any1
            name: x
          - value: any1
            name: y
        return: BOOLEAN
  -
    name: check_overflow
    description: >-
      Rounds the decimal to given scale and check whether the decimal can fit in provided precision
      or not. If not, if `nullOnOverflow` is `true`, it returns `null`; otherwise an
      `ArithmeticException` is thrown.
    impls:
      - args:
          - value: DECIMAL<P,S>
            name: child
          - type: DECIMAL<P,S>
            name: dataType
          - name: nullOnOverflow
            value: boolean
        return: DECIMAL<P,S>